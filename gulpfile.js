const gulp = require("gulp");
const scss = require("gulp-sass");
const minCss = require("gulp-csso");
const minImg = require("gulp-imagemin");
const rename = require("gulp-rename");

function compiller () {
    return gulp.src("./app/scss/styles.scss")
    .pipe(scss())
    .pipe(gulp.dest("./app/css"))
}

function watch () {
    return gulp.watch("./app/scss/**/*.scss", compiller);

}

function imagemin () {
    return gulp.src("./app/img/**/*")
    .pipe(minImg())
    .pipe(gulp.dest("./app/img"))
}

function cssmin () {
    return gulp.src("./app/css/styles.css")
    .pipe(minCss())
    .pipe(rename("styles.min.css"))
    .pipe(gulp.dest("./app/css"))
}

function build () {
    return gulp.src([
        "./app/css/styles.min.css",
        "./app/fonts/*",
        "./app/img/**/*",
        "./app/js/**/*.js",
        "./app/*.html"
    ], {base:"app"})
    .pipe(gulp.dest("dist"))
}

exports.compiller   = compiller; 
exports.watch       = watch;        // компиляция scss в css
exports.imagemin    = imagemin;     // минимизацыя изображения
exports.cssmin      = cssmin;       // минимизацыя css
exports.build       = gulp.series(compiller, cssmin, imagemin, build) ; 
